import spidermonkey



###
#Adobe object class with some property Majic :)
###




class app:
    viewerVersion = 9

    def __init__(self):
        pass

    def document(self):
        return Doc()


    doc = property(document)


class Collab:

    def collectEmailInfo(self, args):
        return "sandeep@versa-networks.com"

    def getIcon(self,args):
        print "Somebody tried to exploit CVE"


class Doc:
    def syncAnnotScan(self):
        print 'syncAnnotScan  ACESSED '

    def getAnnots(self, args):
        # Let's do some magic here later
        return NULL

    def get_collab(self):
        return Collab()

    Collab = property(get_collab) 


class Global(object):

    def get_app(self):
        return app()

    app = property(get_app)














def main():
   rt = spidermonkey.Runtime()
   cx = rt.new_context()
   fp=file("/pdf",'rb')
   code = fp.read()
   print "Testing Spider \n"
   A = app()
   print A 
   cx.add_global("app",A)
   result = cx.execute(code)


if __name__=="__main__":

   main()

