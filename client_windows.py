import socket                   # Import socket module
import time
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("server_ip", type=str, help="Enter server IP")
parser.add_argument("port_num", type=int, help="Enter server port")
parser.add_argument("file_name", type=str, help="Enter File Path")
parser.add_argument("file_type", type=str, help="Enter File Type")
args = parser.parse_args()


host = args.server_ip     # Get local machine name
port = args.port_num                   # Reserve a port for your service.

filename = args.file_name

s = socket.socket()
connected = False
#s.settimeout(500)
while not connected:
	try:
		print "waiting for vm up....."  
		s.connect((host, port))
		connected = True
	except Exception as e:
		pass

s.send(args.file_type)
print s.recv(1024)
s.send(filename)
print s.recv(1024)

f = open("/tmp/"+filename,'rb')
l = f.read(1024)
while (l):
	s.send(l)
       	print('Sent ',repr(l))
       	l = f.read(1024)
f.close()
s.close()
print('connection closed')
