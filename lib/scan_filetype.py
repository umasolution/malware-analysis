import magic
import os
import sys
from swf_client import swf_Class
from ole_client import ole_Class
from js_client import js_Class
from rtf_client import rtf_Class
from pdf_client import pdf_Class
from peframe_client import peframe_Class

class scan_File():
	def __init__(self, filename, md5, filetype):
		self.filename = filename
		self.md5 = md5
		self.filetype = filetype

	def get_results(self):
		if self.filetype == "swf":
			swf = swf_Class(self.filename, self.md5)
			status = swf.swf_Score()
			return status
	
		if self.filetype == "msdos" or self.filetype == "excel" or self.filetype == "ppt":
			ole = ole_Class(self.filename, self.md5)
			status = ole.ole_Score()
			return status

		if self.filetype == "rtf":
			rtf = rtf_Class(self.filename, self.md5)
        		status = rtf.rtf_Score()
			return status
			
		if self.filetype == "pdf":
			pdf = pdf_Class(self.filename, self.md5)
        		status = pdf.pdf_Score()
			return status
			
		if self.filetype == "dll" or self.filetype == "exe":
			pe = peframe_Class(self.filename, self.md5)
        		status = pe.get_Score()
			return status

		if self.filetype == "plain" or self.filetype == "js":
	 		js = js_Class(self.filename, self.md5)
        		status = js.js_Score()
			return status
		
		if self.filetype == "plain" or self.filetype == "html":
			html = html_Class(self.filename, self.md5, None)
        		status = html.html_Score()

				


if __name__ == "__main__":
	res = scan_File('swf-js.file', '31c032f34f1c2561488e898c451e0666', 'swf')
	print res.get_results()


