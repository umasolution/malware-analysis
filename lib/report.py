import subprocess
import time
import os
import json
from urlparse import urlparse


class report_Class():

        def __init__(self, file_name, result, md5):
                self.file_name = file_name
                self.report_name = md5 + ".json"
                self.json_report = md5 + ".json"
		self.result = result
		self.md5sum = md5
		self.res1 = "None"

        def gen_Report(self):
                if self.result == "3":
                        self.res1 = "Malware"

                if self.result == "1":
                        self.res1 = "Clean"

                if self.result == "2":
                        self.res1 = "Suspicious"

                dict1 = {'Result': self.result, 'Virus Status': self.res1}

                with open("report/"+self.md5sum+"/"+ self.json_report) as f:
                        data = json.load(f)

                data.update(dict1)

                with open("report/"+self.md5sum+"/"+self.json_report, 'w') as f:
                        json.dump(data, f)

                with open("report/"+self.md5sum+"/"+self.json_report) as f:
                        data = json.load(f)


                with open("report/"+self.md5sum+"/"+self.json_report) as config_data:
                        cfg = json.load(config_data)

                section1 = cfg['hash']['sha256']

                self.res1 = "https://www.virustotal.com/en/file/" + section1 + "/analysis/"

                dict1 = {'virustotal': self.res1}

                with open("report/"+self.md5sum+"/"+self.json_report) as f:
                        data = json.load(f)

                data.update(dict1)

                with open("report/"+self.md5sum+"/"+self.json_report, 'w') as f:
                        json.dump(data, f)

if __name__ == "__main__":
	gen_report = report_Class('report/31c032f34f1c2561488e898c451e0666/paresh', '3', '31c032f34f1c2561488e898c451e0666')
	gen_report.gen_Report()

