import subprocess
import time
import os
import json

class yaraGen_Class():

	def __init__(self, file_name, md5):
		self.file_name = file_name.split('.')[0]
		self.md5 = md5

	def yara_gen_clean(self):
		os.system("echo 'rule " + self.file_name + "' >> database/clean_file/clean.yara")
		os.system("echo '{' >>  database/clean_file/clean.yara")
		os.system("echo 'meta:' >> database/clean_file/clean.yara")
		os.system("echo	'	description = \"clean file\"' >> database/clean_file/clean.yara")
		os.system("echo '	md5= \"" + self.md5 + "\"' >> database/clean_file/clean.yara")
		os.system("echo 'condition:' >> database/clean_file/clean.yara")
		os.system("echo '	filesize < 1000000000000KB and' >> database/clean_file/clean.yara")
		os.system("echo ' 	hash.md5(0, filesize) == \"" + self.md5 + "\"' >> database/clean_file/clean.yara")
		os.system("echo '}' >> database/clean_file/clean.yara")


	def yara_gen_virus(self):
		os.system("echo 'rule " + self.file_name + "' >> database/virus_file/virus.yara")
		os.system("echo '{' >>  database/virus_file/virus.yara")
		os.system("echo 'meta:' >> database/virus_file/virus.yara")
		os.system("echo	'	description = \"virus file\"' >> database/virus_file/virus.yara")
		os.system("echo '	md5= \"" + self.md5 + "\"' >> database/virus_file/virus.yara")
		os.system("echo 'condition:' >> database/virus_file/virus.yara")
		os.system("echo '	filesize < 1000000000000KB and' >> database/virus_file/virus.yara")
		os.system("echo ' 	hash.md5(0, filesize) == \"" + self.md5 + "\"' >> database/virus_file/virus.yara")
		os.system("echo '}' >> database/virus_file/virus.yara")


	def yara_gen_susc(self):
		os.system("echo 'rule " + self.file_name + "' >> database/susc_file/susc.yara")
		os.system("echo '{' >>  database/susc_file/susc.yara")
		os.system("echo 'meta:' >> database/susc_file/susc.yara")
		os.system("echo	'	description = \"virus file\"' >> database/susc_file/susc.yara")
		os.system("echo '	md5= \"" + self.md5 + "\"' >> database/susc_file/susc.yara")
		os.system("echo 'condition:' >> database/susc_file/susc.yara")
		os.system("echo '	filesize < 1000000000000KB and' >> database/susc_file/susc.yara")
		os.system("echo ' 	hash.md5(0, filesize) == \"" + self.md5 + "\"' >> database/susc_file/susc.yara")
		os.system("echo '}' >> database/susc_file/susc.yara")
