import magic
import os
import sys
import logfile
import logging

logger = logging.getLogger('filetype')

class Scan_filetype():
	def __init__(self, filepath, md5):
		self.filepath = filepath
		self.md5 = md5

	def get_filetype(self):
		ftype = magic.from_file(self.filepath, mime=True)
		
		if ftype == "application/pdf1":
			filetype = "pdf"
		elif ftype == "application/msword":
			filetype = "msdos"
		elif ftype == "application/x-tar":
			filetype = "tar"
		elif ftype == "application/zip":
			filetype = "zip"
		elif ftype == "text/rtf":
			filetype = "rtf"
		elif ftype == "application/x-dosexec":
			filetype = "exe"
		elif ftype == "text/html":
			filetype = "html"
		elif ftype == "application/jar":
			filetype = "jar"
		elif ftype == "text/plain":
			filetype = "text"
		elif ftype == "application/vnd.ms-excel":
			filetype = "excel"
		elif ftype == "text/plain":
			filetype = "plain"
		elif ftype == "application/x-shockwave-flash":
			filetype = "swf"
		else:
			filetype = "any"

		logger.info("Get File %s File Type : %s" % (self.filepath, filetype))
		return filetype



if __name__ == "__main__":
	res = Scan_filetype('swf-js.file', '31c032f34f1c2561488e898c451e0666')
	print res.scan_results()


